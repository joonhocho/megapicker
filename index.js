const history = [
  ['10/16/2018', '3', '45', '49', '61', '69', '9', '5'],
  ['10/12/2018', '4', '24', '46', '61', '70', '7', '3'],
  ['10/9/2018', '20', '22', '39', '54', '60', '18', '3'],
  ['10/5/2018', '27', '28', '32', '41', '69', '12', '2'],
  ['10/2/2018', '2', '22', '29', '31', '34', '1', '3'],
  ['9/28/2018', '39', '45', '52', '56', '59', '15', '3'],
  ['9/25/2018', '8', '16', '32', '48', '61', '12', '2'],
  ['9/21/2018', '1', '2', '11', '52', '64', '9', '4'],
  ['9/18/2018', '31', '32', '43', '63', '68', '17', '2'],
  ['9/14/2018', '23', '30', '40', '43', '66', '13', '4'],
  ['9/11/2018', '15', '30', '51', '62', '67', '19', '2'],
  ['9/7/2018', '8', '10', '41', '54', '68', '10', '2'],
  ['9/4/2018', '2', '7', '25', '35', '44', '3', '3'],
  ['8/31/2018', '7', '18', '29', '32', '45', '17', '3'],
  ['8/28/2018', '3', '20', '33', '34', '41', '20', '3'],
  ['8/24/2018', '1', '6', '13', '18', '49', '8', '2'],
  ['8/21/2018', '14', '16', '19', '38', '57', '11', '3'],
  ['8/17/2018', '1', '31', '32', '47', '56', '3', '2'],
  ['8/14/2018', '11', '26', '44', '45', '46', '11', '2'],
  ['8/10/2018', '1', '3', '12', '22', '42', '6', '5'],
  ['8/7/2018', '2', '13', '15', '21', '62', '2', '5'],
  ['8/3/2018', '9', '28', '30', '54', '60', '2', '2'],
  ['7/31/2018', '12', '15', '35', '64', '69', '9', '2'],
  ['7/27/2018', '1', '32', '40', '49', '63', '20', '3'],
  ['7/24/2018', '1', '2', '4', '19', '29', '20', '3'],
  ['7/20/2018', '1', '14', '30', '44', '62', '1', '2'],
  ['7/17/2018', '40', '41', '61', '66', '67', '12', '5'],
  ['7/13/2018', '21', '22', '39', '59', '68', '2', '2'],
  ['7/10/2018', '1', '17', '28', '56', '70', '14', '3'],
  ['7/6/2018', '2', '10', '46', '50', '56', '16', '3'],
  ['7/3/2018', '13', '35', '45', '49', '68', '23', '2'],
  ['6/29/2018', '2', '32', '47', '49', '68', '23', '4'],
  ['6/26/2018', '17', '25', '29', '39', '60', '19', '2'],
  ['6/22/2018', '2', '6', '11', '27', '44', '20', '2'],
  ['6/19/2018', '11', '13', '28', '65', '70', '14', '3'],
  ['6/15/2018', '1', '11', '37', '47', '51', '6', '2'],
  ['6/12/2018', '1', '3', '5', '8', '70', '3', '2'],
  ['6/8/2018', '14', '30', '33', '44', '56', '13', '2'],
  ['6/5/2018', '22', '33', '41', '48', '52', '4', '2'],
  ['6/1/2018', '5', '24', '52', '62', '66', '17', '3'],
  ['5/29/2018', '2', '11', '55', '58', '67', '2', '3'],
  ['5/25/2018', '11', '14', '51', '64', '68', '25', '4'],
  ['5/22/2018', '16', '17', '21', '36', '48', '9', '3'],
  ['5/18/2018', '9', '26', '53', '64', '66', '11', '2'],
  ['5/15/2018', '21', '34', '44', '49', '61', '21', '2'],
  ['5/11/2018', '14', '38', '40', '53', '70', '22', '3'],
  ['5/8/2018', '8', '15', '39', '64', '67', '13', '2'],
  ['5/4/2018', '4', '5', '10', '12', '18', '21', '4'],
  ['5/1/2018', '2', '7', '20', '55', '70', '1', '4'],
  ['4/27/2018', '2', '29', '38', '63', '66', '11', '2'],
  ['4/24/2018', '3', '19', '31', '32', '48', '10', '3'],
  ['4/20/2018', '1', '15', '18', '32', '45', '4', '2'],
  ['4/17/2018', '12', '34', '44', '47', '65', '22', '4'],
  ['4/13/2018', '8', '9', '32', '42', '59', '10', '4'],
  ['4/10/2018', '5', '13', '31', '43', '53', '20', '2'],
  ['4/6/2018', '16', '33', '51', '54', '67', '20', '4'],
  ['4/3/2018', '4', '29', '39', '42', '62', '14', '2'],
  ['3/30/2018', '11', '28', '31', '46', '59', '1', '3'],
  ['3/27/2018', '7', '25', '43', '56', '59', '13', '3'],
  ['3/23/2018', '4', '8', '23', '53', '59', '17', '3'],
  ['3/20/2018', '14', '38', '51', '64', '70', '9', '3'],
  ['3/16/2018', '1', '13', '26', '33', '52', '11', '3'],
  ['3/13/2018', '6', '30', '58', '60', '61', '17', '5'],
  ['3/9/2018', '7', '17', '18', '46', '66', '22', '4'],
  ['3/6/2018', '1', '4', '26', '35', '39', '22', '5'],
  ['3/2/2018', '24', '28', '42', '60', '64', '8', '4'],
  ['2/27/2018', '10', '17', '21', '38', '43', '23', '3'],
  ['2/23/2018', '7', '11', '13', '19', '58', '9', '4'],
  ['2/20/2018', '17', '19', '23', '24', '43', '14', '3'],
  ['2/16/2018', '14', '38', '48', '53', '58', '16', '3'],
  ['2/13/2018', '5', '12', '15', '46', '49', '1', '4'],
  ['2/9/2018', '28', '34', '41', '46', '47', '14', '3'],
  ['2/6/2018', '14', '17', '25', '48', '58', '25', '3'],
  ['2/2/2018', '1', '4', '14', '17', '40', '4', '3'],
  ['1/30/2018', '29', '41', '42', '49', '57', '24', '3'],
  ['1/26/2018', '10', '16', '27', '38', '43', '1', '4'],
  ['1/23/2018', '2', '6', '30', '31', '55', '7', '4'],
  ['1/19/2018', '3', '17', '23', '49', '66', '23', '3'],
  ['1/16/2018', '3', '11', '23', '29', '59', '18', '3'],
  ['1/12/2018', '17', '18', '33', '46', '60', '24', '4'],
  ['1/9/2018', '16', '29', '31', '65', '67', '23', '3'],
  ['1/5/2018', '28', '30', '39', '59', '70', '10', '3'],
  ['1/2/2018', '1', '42', '47', '64', '70', '22', '4'],
  ['12/29/2017', '4', '10', '18', '28', '62', '7', '2'],
  ['12/26/2017', '10', '12', '20', '38', '41', '25', '4'],
  ['12/22/2017', '1', '20', '30', '33', '42', '16', '4'],
  ['12/19/2017', '28', '37', '39', '42', '58', '2', '3'],
  ['12/15/2017', '4', '12', '36', '44', '57', '19', '4'],
  ['12/12/2017', '8', '23', '24', '25', '27', '9', '2'],
  ['12/8/2017', '6', '37', '46', '60', '70', '24', '2'],
  ['12/5/2017', '14', '15', '37', '42', '67', '22', '4'],
  ['12/1/2017', '16', '22', '40', '41', '59', '8', '4'],
  ['11/28/2017', '10', '17', '47', '51', '61', '5', '2'],
  ['11/24/2017', '16', '36', '54', '61', '64', '22', '3'],
  ['11/21/2017', '3', '7', '22', '27', '50', '3', '3'],
  ['11/17/2017', '3', '26', '55', '58', '70', '15', '4'],
  ['11/14/2017', '1', '14', '21', '22', '28', '19', '3'],
  ['11/10/2017', '6', '23', '38', '42', '58', '24', '2'],
  ['11/7/2017', '1', '54', '60', '68', '69', '11', '4'],
  ['11/3/2017', '10', '22', '42', '61', '69', '3', '2'],
];

const allBalls = [];
const allMega = [];
const ballCounts = {};
for (let i = 1; i <= 70; i++) {
  ballCounts[i] = 0;
}
const megaCounts = {};
for (let i = 1; i <= 25; i++) {
  megaCounts[i] = 0;
}

history.forEach((row) => {
  const balls = row.slice(1, 6).map((x) => parseInt(x, 10));
  const mega = parseInt(row[6], 10);
  allBalls.push(...balls);
  allMega.push(mega);
  balls.forEach((b) => {
    ballCounts[b]++;
  });
  megaCounts[mega]++;
});

const getProbs = (counts) => {
  const numbers = Object.keys(counts);

  let allCounts = 0;
  numbers.forEach((n) => {
    allCounts += counts[n];
  });

  const probs = {};
  numbers.forEach((n) => {
    probs[n] = allCounts - counts[n];
  });

  return probs;
};

const pick = (probs) => {
  const nums = Object.keys(probs);
  const pSum = nums.reduce((s, n) => s + probs[n], 0);
  const len = nums.length;
  let r = Math.random() * pSum;
  for (let i = 0; i < len; i += 1) {
    const n = nums[i];
    r -= probs[n];
    if (r <= 0) {
      return n;
    }
  }
  return pick(probs);
};

const ballProbs = getProbs(ballCounts);
const megaProbs = getProbs(megaCounts);

for (let i = 0; i < 1000; i++) {
  let balls = [];
  let bProbs = { ...ballProbs };
  for (let j = 0; j < 5; j++) {
    const n = parseInt(pick(bProbs), 10);
    if (n < 1 || n > 70) {
      throw new Error(`bad number ${n}`);
    }
    if (balls.indexOf(n) >= 0) {
      throw new Error(`dup number ${n}`);
    }
    balls.push(n);
    delete bProbs[n];
  }

  const mega = parseInt(pick(megaProbs), 10);
  if (mega < 1 || mega > 25) {
    throw new Error(`bad number ${mega}`);
  }

  console.log(balls, mega);
}
